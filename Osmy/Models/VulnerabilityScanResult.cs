using Osmy.Models.Sbom;
using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace Osmy.Models
{
    public class VulnerabilityScanResult
    {
        [Key]
        public int Id { get; set; }

        public int SoftwareId { get; set; }
        public virtual Software Software { get; set; }

        public DateTime Executed { get; set; }
        public virtual List<PackageScanResult> Results { get; set; }

        public VulnerabilityScanResult()
        {
            Executed = DateTime.Now;
            Results = new List<PackageScanResult>();
            Software = default!;
        }

        public VulnerabilityScanResult(Software software) : this()
        {
            Software = software;
        }
    }
}
