namespace Osmy.Core.Data.Sbom
{
    public sealed class VulnerabilityScanResult
    {
        public int Id { get; set; }

        public int SbomId { get; set; }

        public DateTime Executed { get; set; }

        public bool IsVulnerable { get; set; }

        public List<PackageScanResult> Results { get; set; }

        public VulnerabilityScanResult() : this(default, default, DateTime.Now, Enumerable.Empty<PackageScanResult>()) { }

        public VulnerabilityScanResult(int id, int sbomId, DateTime executed, IEnumerable<PackageScanResult> results)
        {
            Id = id;
            SbomId = sbomId;
            Executed = executed;
            Results = new List<PackageScanResult>(results);
            IsVulnerable = Results.Any(x => x.IsVulnerable);
        }
    }
}
